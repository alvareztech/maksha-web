<form>
  <md-toolbar>
    <button md-button (click)="returnLabs()">LABS</button>
    <span *ngIf="isLabSelected">
      <a md-button href="https://beta.alvarez.tech/labs/{{ currentLab?.$key }}"
         target="_blank">/{{currentLab?.$key}}</a>
    </span>
    <span *ngIf="isLabSelected">
      <a md-button
         href="https://console.firebase.google.com/project/maksha-41f4f/database/data/labs/{{ currentLab?.$key }}"
         target="_blank">/firebase</a>
    </span>
    <span class="dottech-spacer"></span>
    <button md-raised-button (click)="newLab()" *ngIf="!isLabSelected">NEW</button>
    <button md-raised-button color="primary" (click)="saveLab()" *ngIf="isLabSelected">SAVE</button>
  </md-toolbar>
  <div class="container-fluid">
    <div *ngIf="!isLabSelected" class="row">
      <md-list>
        <md-list-item *ngFor="let lab of labs | async" (click)="goLab(lab)">
          <md-icon md-list-icon>folder</md-icon>
          <h4 md-line>{{ lab.title }}</h4>
          <p md-line>{{ lab.updated | date }}</p>
        </md-list-item>
      </md-list>
    </div>

    <div class="row" *ngIf="isLabSelected">

      <div class="col-8 dot">
        <md-card>

          <md-input-container>
            <input mdInput placeholder="Title" [(ngModel)]="currentLab.title" name="Title">
          </md-input-container>

          <md-input-container *ngIf="isNewLab">
            <input mdInput placeholder="Identifier" [(ngModel)]="currentLab.$key" name="Identifier">
          </md-input-container>

          <md-input-container>
            <input mdInput id="stepTitle"
                   placeholder="Step title" [(ngModel)]="currentStep.title" name="Step Title">
          </md-input-container>

          <md-input-container>
            <textarea mdInput rows="25" [(ngModel)]="currentStep.content" name="Content"></textarea>
          </md-input-container>

        </md-card>
      </div>

      <div class="col">
        <md-card>

          <div class="row">
            <div class="col">
              <md-select id="techLab" [(ngModel)]="currentLab.technology" name="Technology" required ngDefaultControl>
                <md-option *ngFor="let tech of technologyService.getTechnologies()" [value]="tech.id">{{ tech.name }}
                </md-option>
              </md-select>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <md-select id="levelLab" name="Level" [(ngModel)]="currentLab.level" required ngDefaultControl>
                <md-option *ngFor="let level of technologyService.getLevels()" [value]="level.id">{{ level.name }}
                </md-option>
              </md-select>
            </div>
          </div>

          <md-button-toggle-group #group="mdButtonToggleGroup">
            <md-button-toggle *ngFor="let x of currentLab.steps; let i = index;" (click)="setStep(i)">
              {{ i }}
            </md-button-toggle>
          </md-button-toggle-group>

          <div class="row">
            <div class="col">
              <button md-button (click)="newStep()">New step</button>
            </div>
          </div>

          <md-checkbox [(ngModel)]="currentLab.published" name="Published" ngDefaultControl>Published
          </md-checkbox>

        </md-card>
      </div>

    </div>

  </div>
</form>
